!function(){"use strict";var t={762:function(t,e,n){t.exports=n.p+"dist/images/a3f5dda651f48fbfd11b.svg"},777:function(t,e,n){t.exports=n.p+"dist/images/9abac4b0500e309b3467.svg"}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,n),a.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../../"}(),function(){var t={apiKey:"d62132a71a9144c3594bd6a136b16dfc",baseUrl:"https://api.openweathermap.org/",get:function(t,e){var n="".concat(this.baseUrl,"data/2.5/weather?lat=").concat(t,"&lon=").concat(e,"&appid=").concat(this.apiKey);return fetch(n).then((function(t){return t.json()}))},findCityCoords:function(t){var e="".concat(this.baseUrl,"geo/1.0/direct?q=").concat(t,"&limit=1&appid=").concat(this.apiKey);return fetch(e).then((function(t){return t.json()})).then((function(t){return new Promise((function(e,n){t[0]&&e(t[0]),n(new Error("City was not found"))}))}))},toCelsius:function(t){return parseFloat(t)-273.15}},e=function(){return fetch("https://get.geojs.io/v1/ip/geo.json").then((function(t){return t.json()}))};function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function r(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),r(this,"apiKey","AIzaSyB1RMnKzcvlp3v90ei9EUIFlAn5qbFuzqc"),r(this,"baseUrl","https://maps.googleapis.com/maps/api/staticmap"),r(this,"container",void 0),this.container=e}var e,n;return e=t,(n=[{key:"render",value:function(t,e){var n={key:this.apiKey,size:"640x640",center:"".concat(t,",").concat(e),zoom:10,map_id:"fa7cf5ec5edea579"},i=new URLSearchParams(n),r="".concat(this.baseUrl,"?").concat(i.toString()),a=document.createElement("img");a.src=r,this.container.innerHTML="",this.container.append(a)}}])&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),o=n(777),s=n(762);function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=new(function(){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),u(this,"rootElement",void 0),u(this,"city",void 0),u(this,"t",void 0),u(this,"form",void 0),u(this,"input",void 0),u(this,"searchHistory",void 0),u(this,"storage",void 0),u(this,"map",void 0),u(this,"onSubmitSearch",(function(t){t.preventDefault(),n.showCityWeather(n.input.value)})),u(this,"onClickCity",(function(t){n.showCityWeather(t.target.innerHTML)})),this.rootElement=t,this.storage=window.localStorage,this.makeLayout(this.rootElement),this.addWeatherMarkup(this.rootElement.querySelector(".weather-data")),this.addSearchForm(this.rootElement.querySelector(".weather-search")),this.map=new a(this.rootElement.querySelector(".map-panel")),this.searchHistory=this.rootElement.querySelector(".search-history"),this.city.innerHTML="Определяем ваше местоположение... Разрешите геолокацию",this.renderSearchHistory(this.getHistory())}var n,i;return n=e,(i=[{key:"makeLayout",value:function(){this.rootElement.innerHTML='\n      <div id="container">\n        <div class="row weather-panel">\n          <div class="weather-wrapper">\n            <div class="weather-data"></div>\n            <div class="weather-search"></div>\n            <div class="search-history"></div>\n          </div>\n        </div>\n        <div class="row map-panel"></div>\n      </div>\n    '}},{key:"addWeatherMarkup",value:function(t){return this.img=document.createElement("img"),this.img.src=o,this.img.className="weather-data__icon",this.t=document.createElement("p"),this.t.className="weather-data__temp",this.city=document.createElement("p"),this.city.className="weather-data__city",t.append(this.img),t.append(this.t),t.append(this.city),t}},{key:"addSearchForm",value:function(t){return t.innerHTML='\n      <div class="text-field">\n        <div class="text-field__icon">\n          <form class="city-form">\n            <input\n              class="text-field__input"\n              type="search"\n              name="city"\n              placeholder="Город"\n            />\n          </form>\n          <span class="text-field__aicon">\n            <img src="'.concat(s,'" alt="Submit form" />\n          </span>\n        </div>\n      </div>\n    '),this.form=this.rootElement.querySelector(".city-form"),this.input=this.rootElement.querySelector(".text-field__input"),this.form.addEventListener("submit",this.onSubmitSearch),t}},{key:"render",value:function(e){var n=t.toCelsius(e.main.temp);this.t.innerHTML="".concat((n>0?"+":"")+n.toFixed(),"°C"),this.city.innerHTML=e.name,this.renderSearchHistory(this.getHistory()),this.map.render(e.coord.lat,e.coord.lon)}},{key:"renderSearchHistory",value:function(t){var e=this;this.searchHistory.innerHTML="",t.forEach((function(t){var n=document.createElement("button");n.className="tag-btn",n.innerHTML=t,n.addEventListener("click",e.onClickCity),e.searchHistory.append(n)}))}},{key:"showCityWeather",value:function(e){var n=this;this.lockPage(),t.findCityCoords(e).then((function(e){return t.get(e.lat,e.lon)})).then((function(t){n.saveHistory(e),n.render(t)})).catch((function(t){return console.error(t)})).finally((function(){return n.unlockPage()}))}},{key:"saveHistory",value:function(t){var e=this.getHistory();(e=e.filter((function(e){return e!==t}))).push(t),this.storage.setItem("history",JSON.stringify(e))}},{key:"getHistory",value:function(){return(JSON.parse(this.storage.getItem("history"))||[]).reverse()}},{key:"lockPage",value:function(){this.input.disabled=!0}},{key:"unlockPage",value:function(){this.input.disabled=!1,this.input.value=""}}])&&c(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),e}())(document.getElementById("app"));e().then((function(e){return t.get(e.latitude,e.longitude)})).then((function(t){return h.render(t)}))}()}();
//# sourceMappingURL=bundle.js.map