!function(){"use strict";var t={762:function(t,e,n){t.exports=n.p+"dist/images/a3f5dda651f48fbfd11b.svg"},777:function(t,e,n){t.exports=n.p+"dist/images/9abac4b0500e309b3467.svg"}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={exports:{}};return t[r](o,o.exports,n),o.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),function(){var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var r=e.getElementsByTagName("script");r.length&&(t=r[r.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t+"../../"}(),function(){var t={apiKey:"d62132a71a9144c3594bd6a136b16dfc",baseUrl:"https://api.openweathermap.org/",get:function(t,e){var n="".concat(this.baseUrl,"data/2.5/weather?lat=").concat(t,"&lon=").concat(e,"&appid=").concat(this.apiKey);return fetch(n).then((function(t){return t.ok?t.json():Promise.reject(t)})).catch((function(t){return new Error(t)}))},findCityCoords:function(t){var e="".concat(this.baseUrl,"geo/1.0/direct?q=").concat(t,"&limit=1&appid=").concat(this.apiKey);return fetch(e).then((function(t){return t.ok?t.json():Promise.reject(t)})).then((function(t){return new Promise((function(e,n){t[0]&&e(t[0]),n(new Error("City was not found"))}))})).catch((function(t){return console.log("Error: ",t)}))},toCelsius:function(t){return parseFloat(t)-273.15}},e=function(){return fetch("https://get.geojs.io/v1/ip/geo.json").then((function(t){return t.ok?t.json():Promise.reject(t)})).catch((function(t){return console.log("Error: ",t)}))};function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var o=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,"apiKey","AIzaSyB1RMnKzcvlp3v90ei9EUIFlAn5qbFuzqc"),i(this,"baseUrl","https://maps.googleapis.com/maps/api/staticmap"),this.container=e}var e,n;return e=t,(n=[{key:"render",value:function(t,e){var n={key:this.apiKey,size:"640x640",center:"".concat(t,",").concat(e),zoom:10,map_id:"fa7cf5ec5edea579"},r=new URLSearchParams(n),i="".concat(this.baseUrl,"?").concat(r.toString()),o=document.createElement("img");o.src=i,this.container.innerHTML="",this.container.append(o)}}])&&r(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}(),a=n(777),c=n(762);function s(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),u(this,"KEY","history"),u(this,"storage",void 0),this.storage=e}var e,n;return e=t,(n=[{key:"add",value:function(t){var e=this.get();(e=e.filter((function(e){return e!==t}))).unshift(t),e=e.splice(0,10),this.storage.setItem("history",JSON.stringify(e))}},{key:"get",value:function(){return JSON.parse(this.storage.getItem(this.KEY))||[]}}])&&s(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),t}();function l(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function f(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var d=new(function(){function e(t){var n=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"rootElement",void 0),f(this,"city",void 0),f(this,"t",void 0),f(this,"form",void 0),f(this,"input",void 0),f(this,"searchHistory",void 0),f(this,"history",void 0),f(this,"map",void 0),f(this,"onSubmitSearch",(function(t){t.preventDefault(),n.showCityWeather(n.input.value)})),f(this,"onClickCity",(function(t){n.showCityWeather(t.target.innerHTML)})),this.rootElement=t,this.history=new h(window.localStorage),this.makeLayout(this.rootElement),this.addWeatherMarkup(this.rootElement.querySelector(".weather-data")),this.addSearchForm(this.rootElement.querySelector(".weather-search")),this.map=new o(this.rootElement.querySelector(".map-panel")),this.searchHistory=this.rootElement.querySelector(".search-history"),this.city.innerHTML="Определяем ваше местоположение...",this.renderSearchHistory(this.history.get())}var n,r;return n=e,(r=[{key:"makeLayout",value:function(){this.rootElement.innerHTML='\n      <div id="container">\n        <div class="row weather-panel">\n          <div class="weather-wrapper">\n            <div class="weather-data"></div>\n            <div class="weather-search"></div>\n            <div class="search-history"></div>\n          </div>\n        </div>\n        <div class="row map-panel"></div>\n      </div>\n    '}},{key:"addWeatherMarkup",value:function(t){return this.img=document.createElement("img"),this.img.src=a,this.img.className="weather-data__icon",this.t=document.createElement("p"),this.t.className="weather-data__temp",this.city=document.createElement("p"),this.city.className="weather-data__city",t.append(this.img),t.append(this.t),t.append(this.city),t}},{key:"addSearchForm",value:function(t){return t.innerHTML='\n      <div class="text-field">\n        <div class="text-field__icon">\n          <form class="city-form">\n            <input\n              class="text-field__input"\n              type="search"\n              name="city"\n              placeholder="Город"\n            />\n          </form>\n          <span class="text-field__aicon">\n            <img src="'.concat(c,'" alt="Submit form" />\n          </span>\n        </div>\n      </div>\n    '),this.form=this.rootElement.querySelector(".city-form"),this.input=this.rootElement.querySelector(".text-field__input"),this.form.addEventListener("submit",this.onSubmitSearch),t}},{key:"render",value:function(e){var n=t.toCelsius(e.main.temp);this.t.innerHTML="".concat((n>0?"+":"")+n.toFixed(),"°C"),this.city.innerHTML=e.name,this.renderSearchHistory(this.history.get()),this.map.render(e.coord.lat,e.coord.lon)}},{key:"renderSearchHistory",value:function(t){var e=this;this.searchHistory.innerHTML="",t.forEach((function(t){var n=document.createElement("button");n.className="tag-btn",n.innerHTML=t,n.addEventListener("click",e.onClickCity),e.searchHistory.append(n)}))}},{key:"showCityWeather",value:function(e){var n=this;return this.lockPage(),t.findCityCoords(e).then((function(e){return t.get(e.lat,e.lon)})).then((function(t){n.history.add(e),n.render(t)})).catch((function(t){return console.error(t)})).finally((function(){return n.unlockPage()}))}},{key:"lockPage",value:function(){this.input.disabled=!0}},{key:"unlockPage",value:function(){this.input.disabled=!1,this.input.value=""}}])&&l(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),e}())(document.getElementById("app"));e().then((function(e){return t.get(e.latitude,e.longitude)})).then((function(t){return d.render(t)}))}()}();
//# sourceMappingURL=bundle.js.map